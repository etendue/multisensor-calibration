<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <text x="200" y="25" font-family="Arial" font-size="22" font-weight="bold">Factor Graph Optimization for Multisensor Calibration</text>

  <!-- Vehicle Poses - Spread out more horizontally -->
  <circle cx="100" cy="200" r="25" fill="#bbf" stroke="black" stroke-width="2"/>
  <text x="95" y="205" font-family="Arial" font-size="16" font-weight="bold">P₁</text>
  <text x="80" y="240" font-family="Arial" font-size="14">Pose 1</text>

  <circle cx="250" cy="200" r="25" fill="#bbf" stroke="black" stroke-width="2"/>
  <text x="245" y="205" font-family="Arial" font-size="16" font-weight="bold">P₂</text>
  <text x="230" y="240" font-family="Arial" font-size="14">Pose 2</text>

  <circle cx="400" cy="200" r="25" fill="#bbf" stroke="black" stroke-width="2"/>
  <text x="395" y="205" font-family="Arial" font-size="16" font-weight="bold">P₃</text>
  <text x="380" y="240" font-family="Arial" font-size="14">Pose 3</text>

  <circle cx="550" cy="200" r="25" fill="#bbf" stroke="black" stroke-width="2"/>
  <text x="545" y="205" font-family="Arial" font-size="16" font-weight="bold">P₄</text>
  <text x="530" y="240" font-family="Arial" font-size="14">Pose 4</text>

  <!-- Landmarks - Positioned below with more space -->
  <circle cx="150" cy="350" r="20" fill="#fbb" stroke="black" stroke-width="2"/>
  <text x="145" y="355" font-family="Arial" font-size="16" font-weight="bold">L₁</text>

  <circle cx="300" cy="350" r="20" fill="#fbb" stroke="black" stroke-width="2"/>
  <text x="295" y="355" font-family="Arial" font-size="16" font-weight="bold">L₂</text>

  <circle cx="450" cy="350" r="20" fill="#fbb" stroke="black" stroke-width="2"/>
  <text x="445" y="355" font-family="Arial" font-size="16" font-weight="bold">L₃</text>

  <!-- Camera Parameters - Positioned at top with clear labels -->
  <rect x="150" y="100" width="40" height="40" fill="#fbf" stroke="black" stroke-width="2"/>
  <text x="165" y="125" font-family="Arial" font-size="16" font-weight="bold">K</text>
  <text x="120" y="80" font-family="Arial" font-size="14">Camera Intrinsics</text>

  <rect x="300" y="100" width="40" height="40" fill="#fbf" stroke="black" stroke-width="2"/>
  <text x="315" y="125" font-family="Arial" font-size="16" font-weight="bold">E</text>
  <text x="270" y="80" font-family="Arial" font-size="14">Camera Extrinsics</text>

  <rect x="450" y="100" width="40" height="40" fill="#fbf" stroke="black" stroke-width="2"/>
  <text x="465" y="125" font-family="Arial" font-size="16" font-weight="bold">B</text>
  <text x="440" y="80" font-family="Arial" font-size="14">IMU Bias</text>

  <!-- Prior factors - Clearly positioned -->
  <polygon points="100,160 85,145 115,145" fill="#bfb" stroke="black" stroke-width="2"/>
  <text x="70" y="135" font-family="Arial" font-size="14">Prior</text>

  <polygon points="150,60 135,45 165,45" fill="#bfb" stroke="black" stroke-width="2"/>
  <text x="120" y="35" font-family="Arial" font-size="14">Prior</text>

  <polygon points="300,60 285,45 315,45" fill="#bfb" stroke="black" stroke-width="2"/>
  <text x="270" y="35" font-family="Arial" font-size="14">Prior</text>

  <polygon points="450,60 435,45 465,45" fill="#bfb" stroke="black" stroke-width="2"/>
  <text x="420" y="35" font-family="Arial" font-size="14">Prior</text>

  <!-- IMU factors - Clearly positioned between poses -->
  <rect x="175" y="200" width="30" height="30" fill="orange" stroke="black" stroke-width="2"/>
  <text x="183" y="220" font-family="Arial" font-size="16" font-weight="bold">I</text>

  <rect x="325" y="200" width="30" height="30" fill="orange" stroke="black" stroke-width="2"/>
  <text x="333" y="220" font-family="Arial" font-size="16" font-weight="bold">I</text>

  <rect x="475" y="200" width="30" height="30" fill="orange" stroke="black" stroke-width="2"/>
  <text x="483" y="220" font-family="Arial" font-size="16" font-weight="bold">I</text>

  <!-- Wheel odometry factors - Positioned above IMU factors -->
  <rect x="175" y="150" width="30" height="30" fill="yellow" stroke="black" stroke-width="2"/>
  <text x="183" y="170" font-family="Arial" font-size="16" font-weight="bold">W</text>

  <rect x="325" y="150" width="30" height="30" fill="yellow" stroke="black" stroke-width="2"/>
  <text x="333" y="170" font-family="Arial" font-size="16" font-weight="bold">W</text>

  <rect x="475" y="150" width="30" height="30" fill="yellow" stroke="black" stroke-width="2"/>
  <text x="483" y="170" font-family="Arial" font-size="16" font-weight="bold">W</text>

  <!-- Reprojection factors - Clearly positioned -->
  <polygon points="125,275 110,260 140,260" fill="cyan" stroke="black" stroke-width="2"/>
  <text x="125" y="280" font-family="Arial" font-size="16" font-weight="bold">R</text>

  <polygon points="200,275 185,260 215,260" fill="cyan" stroke="black" stroke-width="2"/>
  <text x="200" y="280" font-family="Arial" font-size="16" font-weight="bold">R</text>

  <polygon points="275,275 260,260 290,260" fill="cyan" stroke="black" stroke-width="2"/>
  <text x="275" y="280" font-family="Arial" font-size="16" font-weight="bold">R</text>

  <polygon points="350,275 335,260 365,260" fill="cyan" stroke="black" stroke-width="2"/>
  <text x="350" y="280" font-family="Arial" font-size="16" font-weight="bold">R</text>

  <polygon points="425,275 410,260 440,260" fill="cyan" stroke="black" stroke-width="2"/>
  <text x="425" y="280" font-family="Arial" font-size="16" font-weight="bold">R</text>

  <polygon points="500,275 485,260 515,260" fill="cyan" stroke="black" stroke-width="2"/>
  <text x="500" y="280" font-family="Arial" font-size="16" font-weight="bold">R</text>

  <!-- Connections - Simplified and clearer -->
  <!-- Prior connections -->
  <line x1="100" y1="145" x2="100" y2="175" stroke="black" stroke-width="1.5"/>
  <line x1="150" y1="45" x2="150" y2="100" stroke="black" stroke-width="1.5"/>
  <line x1="300" y1="45" x2="300" y2="100" stroke="black" stroke-width="1.5"/>
  <line x1="450" y1="45" x2="450" y2="100" stroke="black" stroke-width="1.5"/>

  <!-- IMU connections -->
  <line x1="125" y1="200" x2="175" y2="200" stroke="black" stroke-width="1.5"/>
  <line x1="205" y1="200" x2="250" y2="200" stroke="black" stroke-width="1.5"/>
  <line x1="275" y1="200" x2="325" y2="200" stroke="black" stroke-width="1.5"/>
  <line x1="355" y1="200" x2="400" y2="200" stroke="black" stroke-width="1.5"/>
  <line x1="425" y1="200" x2="475" y2="200" stroke="black" stroke-width="1.5"/>
  <line x1="505" y1="200" x2="550" y2="200" stroke="black" stroke-width="1.5"/>
  <line x1="450" y1="140" x2="450" y2="200" stroke="black" stroke-width="1.5"/>

  <!-- Wheel odometry connections -->
  <line x1="125" y1="165" x2="175" y2="165" stroke="black" stroke-width="1.5"/>
  <line x1="205" y1="165" x2="250" y2="165" stroke="black" stroke-width="1.5"/>
  <line x1="275" y1="165" x2="325" y2="165" stroke="black" stroke-width="1.5"/>
  <line x1="355" y1="165" x2="400" y2="165" stroke="black" stroke-width="1.5"/>
  <line x1="425" y1="165" x2="475" y2="165" stroke="black" stroke-width="1.5"/>
  <line x1="505" y1="165" x2="550" y2="165" stroke="black" stroke-width="1.5"/>

  <!-- Reprojection connections - Simplified -->
  <!-- P1 to L1 -->
  <line x1="100" y1="225" x2="125" y2="260" stroke="black" stroke-width="1.5"/>
  <line x1="125" y1="260" x2="150" y2="350" stroke="black" stroke-width="1.5"/>
  <line x1="170" y1="120" x2="125" y2="260" stroke="black" stroke-width="1.5" stroke-dasharray="5,3"/>
  <line x1="320" y1="120" x2="125" y2="260" stroke="black" stroke-width="1.5" stroke-dasharray="5,3"/>

  <!-- P2 to L1, L2 -->
  <line x1="250" y1="225" x2="200" y2="260" stroke="black" stroke-width="1.5"/>
  <line x1="200" y1="260" x2="150" y2="350" stroke="black" stroke-width="1.5"/>
  <line x1="250" y1="225" x2="275" y2="260" stroke="black" stroke-width="1.5"/>
  <line x1="275" y1="260" x2="300" y2="350" stroke="black" stroke-width="1.5"/>

  <!-- P3 to L2, L3 -->
  <line x1="400" y1="225" x2="350" y2="260" stroke="black" stroke-width="1.5"/>
  <line x1="350" y1="260" x2="300" y2="350" stroke="black" stroke-width="1.5"/>
  <line x1="400" y1="225" x2="425" y2="260" stroke="black" stroke-width="1.5"/>
  <line x1="425" y1="260" x2="450" y2="350" stroke="black" stroke-width="1.5"/>

  <!-- P4 to L3 -->
  <line x1="550" y1="225" x2="500" y2="260" stroke="black" stroke-width="1.5"/>
  <line x1="500" y1="260" x2="450" y2="350" stroke="black" stroke-width="1.5"/>

  <!-- Camera connections to reprojection factors - Simplified -->
  <line x1="170" y1="120" x2="200" y2="260" stroke="black" stroke-width="1.5" stroke-dasharray="5,3"/>
  <line x1="320" y1="120" x2="200" y2="260" stroke="black" stroke-width="1.5" stroke-dasharray="5,3"/>

  <line x1="170" y1="120" x2="275" y2="260" stroke="black" stroke-width="1.5" stroke-dasharray="5,3"/>
  <line x1="320" y1="120" x2="275" y2="260" stroke="black" stroke-width="1.5" stroke-dasharray="5,3"/>

  <line x1="170" y1="120" x2="350" y2="260" stroke="black" stroke-width="1.5" stroke-dasharray="5,3"/>
  <line x1="320" y1="120" x2="350" y2="260" stroke="black" stroke-width="1.5" stroke-dasharray="5,3"/>

  <line x1="170" y1="120" x2="425" y2="260" stroke="black" stroke-width="1.5" stroke-dasharray="5,3"/>
  <line x1="320" y1="120" x2="425" y2="260" stroke="black" stroke-width="1.5" stroke-dasharray="5,3"/>

  <line x1="170" y1="120" x2="500" y2="260" stroke="black" stroke-width="1.5" stroke-dasharray="5,3"/>
  <line x1="320" y1="120" x2="500" y2="260" stroke="black" stroke-width="1.5" stroke-dasharray="5,3"/>

  <!-- Explanation - Positioned at bottom with clear spacing -->
  <text x="50" y="420" font-family="Arial" font-size="18" font-weight="bold">Factor Graph Components:</text>

  <text x="50" y="450" font-family="Arial" font-size="16">
    • Variables (circles/rectangles): Parameters to be estimated
  </text>
  <text x="50" y="480" font-family="Arial" font-size="16">
    • Factors (triangles/squares): Constraints from measurements
  </text>
  <text x="50" y="510" font-family="Arial" font-size="16">
    • Edges: Connect factors to the variables they constrain
  </text>
  <text x="50" y="540" font-family="Arial" font-size="16">
    • Optimization: Find variable values that minimize the sum of factor errors
  </text>

  <!-- Legend - Positioned on right with clear spacing -->
  <rect x="600" y="300" width="180" height="280" fill="white" stroke="black" stroke-width="1"/>
  <text x="640" y="330" font-family="Arial" font-size="18" font-weight="bold">Legend</text>

  <circle cx="620" cy="360" r="15" fill="#bbf" stroke="black" stroke-width="1"/>
  <text x="645" y="365" font-family="Arial" font-size="16">Vehicle Poses</text>

  <circle cx="620" cy="395" r="15" fill="#fbb" stroke="black" stroke-width="1"/>
  <text x="645" y="400" font-family="Arial" font-size="16">Landmarks</text>

  <rect x="605" y="420" width="30" height="30" fill="#fbf" stroke="black" stroke-width="1"/>
  <text x="645" y="440" font-family="Arial" font-size="16">Parameters</text>

  <polygon points="620,470 605,455 635,455" fill="#bfb" stroke="black" stroke-width="1"/>
  <text x="645" y="470" font-family="Arial" font-size="16">Prior Factors</text>

  <rect x="605" y="485" width="30" height="30" fill="orange" stroke="black" stroke-width="1"/>
  <text x="645" y="505" font-family="Arial" font-size="16">IMU Factors</text>

  <rect x="605" y="525" width="30" height="30" fill="yellow" stroke="black" stroke-width="1"/>
  <text x="645" y="545" font-family="Arial" font-size="16">Wheel Factors</text>

  <polygon points="620,575 605,560 635,560" fill="cyan" stroke="black" stroke-width="1"/>
  <text x="645" y="575" font-family="Arial" font-size="16">Reprojection</text>
</svg>
